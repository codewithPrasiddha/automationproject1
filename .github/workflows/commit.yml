name: Daily Natural Commits

on:
  schedule:
    - cron: '0 11 * * *'   # 7 AM Toronto
    - cron: '0 17 * * *'   # 1 PM Toronto
    - cron: '0 0 * * *'    # 8 PM Toronto
  workflow_dispatch:

jobs:
  auto-commit:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Generate random commit message
      id: vars
      run: |
        messages=(
          "Minor updates and cleanup"
          "Improved formatting in log"
          "Added today's activity"
          "Daily sync ðŸŒ¿"
          "Routine maintenance commit"
          "Refreshed content for the day"
          "Synced logs with new entry"
          "Updated auto-generated content"
          "New log entry ðŸ•’"
        )
        RANDOM_INDEX=$((RANDOM % ${#messages[@]}))
        echo "commit_message=${messages[$RANDOM_INDEX]}" >> $GITHUB_OUTPUT

    - name: Update README.md
      run: |
        echo "## ðŸ—“ï¸ Daily GitHub Activity Log" > README.md
        echo "" >> README.md
        echo "> ðŸ¤– Auto-updated log to keep the contribution streak alive!" >> README.md
        echo "" >> README.md
        echo "### âœ… Commits" >> README.md
        echo "" >> README.md
        echo "- ðŸ•’ $(date -u +"%Y-%m-%d %H:%M UTC") â€” ${{ steps.vars.outputs.commit_message }}" >> README.md
        echo "" >> README.md

    - name: Commit and push
      env:
        GH_PAT: ${{ secrets.GH_PAT }}
      run: |
        git config user.name "Prasiddha Thapaliya"
        git config user.email "pthapaliya@myseneca.ca"
        git add README.md
        git commit -m "${{ steps.vars.outputs.commit_message }}" || echo "Nothing to commit"
        git push
